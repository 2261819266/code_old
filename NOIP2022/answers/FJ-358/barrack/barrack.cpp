#include<bits/stdc++.h>
using namespace std;
int n,m,zb;
long long cnt=0;
vector<int>g[500001];
const int mod=1000000007;

int ys[500001];//点的映射 
struct node
{
	int zcity,zedge;
}cd[600001];
//建立所谓“超点”

bool vis[600001];
int lb[600001];
//存储深搜序列 

//辅助：快速幂 
long long mi(int a,int b)//a^b
{
	if(b==0)return 1;
	if(b==1)return a%mod;
	long long tmp=mi(a,b/2);
	tmp=tmp*tmp%mod;
	if(b%2==1)tmp=tmp*(a%mod)%mod;
	return tmp;
}

void To_Tree(int p,int step)//缩点变树核心代码 
{
	cout<<p<<' '<<step<<endl;
	if(vis[p]==1)
	{
		int pp=lb[p];
		while(pp!=p)
		{
			cd[p].zcity+=cd[pp].zcity;
			cd[p].zedge+=cd[pp].zedge+1;
			ys[pp]=ys[p];
			for(int i=0;i<=g[pp].size();i++)
			{
				g[p].push_back(g[pp][i]);
			}
			zb--;
			pp=ys[lb[pp]];
		}
		cd[p].zedge++;
		return; 
	}
	vis[p]=1;
	for(int i=0;i<=g[p].size();i++)
	{
		int v=ys[g[p][i]];
		lb[v]=p;
		To_Tree(v,step+1);
	}
}

int fa[600001];
long long ans[600001]={};
long long xb[600001];
long long xs[]={1,4,262144,980777197,278114081,589786405,594150226,410703174,345881017,792490631,478097517,63575939,9016597,446760911,1,1,1,1,846421004,1,1,778725276,1,1,1,1,414325688,639519254,672213458,948693449,1,1,1,829498782,1,1,139185108,39132380,1,346078910,1,1,1,1,641721833,1,158349180,1,7422379,1,1,538759801,537161440,1,807024319,1,808743762,712200719,1,76740209,879983551,1,340927836,1,631102936,109835650,1,966427909,1,1,247661416,1,180097792,833017187,1,280870630,657926773,174305834,789956115,476524277,706307025,183736077,475753530,1,1,1,568786393,810208882,632204349,1,1,120720359,58129577,1,1,921253234,199181888,99757168,1,1,1,1,551192357,1,1,634433653,1,404259509,1,882716570,1,186791854,431117830,785190056,836049936,1,1,1,1,1,219971940,797644218,1,5433629,187787353,241398342,604857481,1,707196844,1,1,835249803,594621848,1,1,1,168612365,1,476918854,839701774,662423528,62086105,204511648,837245657,1,1,765408358,876628587,568587592,987685234,898083821,1,1,1,1,1,1,16763943,1,1,1,195882095,260355277,971350027,1,853155578,1,1,619361803,197112979,1,349905444,419274421,102422875,963884619,1,1,1,1,1,606899391,1,464228443,1,781186056,452164030,542852486,1,1,1,761956637,465435065,1,1,565168979,847043242,979565185,1,727045072,1,788981157,1,364565929,325293210,198900208,1,737138130,998460209,308032622,1,348128632,414412295,413072136,600008776,526900610,1,151813481,154706035,1,597093799,1,467607243,254337611,513458170,885280432,353193889,506394521,421701423,382466908,642726562,833456414,278379069,383005254,1,138907329,1,1,45557626,1,1,778524733,1,324195038,583874150,975582892,1,1,672587512,203133727,1,1,1,172649238,981372567,1,61442594,88589959,107005523,1,344655630,535351465,523899968,1,207084822,1,1,842396291,804599761,80260474,1,662065089,1,1,1,1,1,1,1,766860374,440876643,129033493,929610606,696951683,753012239,796749999,892373961,1,1,1,1,518269667,6755544,1,905924994,1,425261802,722014530,1,436640741,813432222,1,808021877,429512301,1,624451322,821811586,328658238,721773783,1,333877909,1,850145738,1,1,840646069,1,1,1,1,731154770,1,1,1,1,193032591,109559038,1,935327423,1,119710103,726362387,1,29131023,1,1,1,270975238,1,1,537234689,1,998038916,1,1,1,1,389529529,1,1,12782737,239527106,944399936,1,869059900,646733945,88067941,628284636,1,181610648,1,195594161,1,746638657,35306468,1,1,1,1,1,989355092,1,590618596,106100238,1,1,1,829195862,693742462,522199520,1,121936984,60430592,1,907903103,869678322,1,1,776713036,489344356,559241761,262416440,1,1,552080372,1,702038028,840388441,32747015,1,726783565,1,354351585,841096969,
535335397,1,1,679934484,1,1,1,352855584,1,1,1,1,392742458,377356536,763391455,1,463171756,1,1,485185055,1,525606987,835154034,490828535,1,1,1,493598977,885198496,1,1,136243500,946180788,346804390,831992990,1,333253631,1,1,1,501944901,1,1,1,1,410968695,1,1,1,1,548887549,260068448,1,1,536414715,1,1,740802979,550912967,1,1,571036247,637819307,1,9357661,1,215317594,364817276,1,1,1,189509242,968825841,720048051,1,1,1,1,409473672,898599918,1,611711848,755286188,448069371,1,317551073,1,1,1,1,606503764,1,30004912,696229981,1,907129473,1,1,241368413,335408414,159747675,19231486,631097993,1,1,22198929,1,310606226,1,1,492549783,530839427,109791939,816125593,1,950675714,1,739194671,566761750,692048651,1,1,1,974471815,1,603393172,356240879,1,1,311196611,1,156430966,1,906123769,1,496162652,1,1,1,1,1,1,428848462,396022764,512143961,1,2532964,454536959,111494695,792224775,1,1,759035589,254239035,1,681202130,1,412946202,941799631,1,697454598,56685622,1,857706102,1,1,264872164,289029123,1,1,996184589,217922853,1,1,1,1,1,1,1,917716007,1,1,492568343,690668123,1,1,1,804758255,94251592,1,625170798,545954025,943555668,1,934691816,1,723603780,1,80720081,114296574,1,1,277911858,386462826,1,1,1,6284709,82264733,1,32671301,632654281,818064584,878126786,1,1,568386581,1,673903740,327574415,1,1,636339164,616259849,1,1,930792466,1,55154420,79657982,245477078,383538233,1,1,802723083,90485099,543960586,1,1,1,1,539420893,1,1,1,566370298,235190375,753316177,751609893,838543671,1,149979103,1,1,277946702,734263924,700449039,1,1,1,285298296,1,711021027,1,1,165299105,1,1,358677072,324982063,732610489,301460640,944832753,1,1,356750399,1,499608042,617212612,1,1,1,613184264,849932104,1,266002380,1,116482632,1,1,1,1,797457178,1,1,1,830054300,999667796,807363915,774470036,192598034,1,1,380644556,1,1,1,1,499888660,1,1,193095854,772935549,707943930,547763233,87589318,1,1,1,546310215,1,1,587529654,1,1,603080952,1,472641410,578057573,1,1,1,1,1,1,498781326,1,1,1,519194195,1,1,509375311,1,391276815,1,597016486,1,1,114320133,168968286,1,415971856,1,939878369,1,449079939,946721715,1,732197616,1,439281912,1,15433399,1,1,219575997,1,1,1,1,1,245497112,1,656477935,1,1,1,535677930,273351178,543196102,1,337955177,47544783,591232573,1,768266512,196885838,1,189989980,1,8569912,513020915,1,1,916717750,1,242827636,613208003,940519094,1,1,1,257279616,331213947,535765405,1,1,1,1,495175759,230870561,91232552,655426476,1,1,1,664573607,402555046,584761938,243528920,1,1,171926626,1,691009909,1,1,931139858,780368297,1,589377562,117897360,1,170027145,1,1,1,30529634,325299814,1,833279121,666463575,1,1,1,1,1,575094822,982079778,554124765,1,111155866,1,1,1,1,1,1,
720378822,1,775191004,88659975,1,1,1,770916882,868370466,196562588,1,456871111,1,1,1,598593809,567550274,1,1,1,381911402,1,869537406,1,1,334481560,1,1,1,69967317,147776995,297917809,597832068,804303678,354181505,451475289,1,1,1,1,583939834,226484293,185377887,1,5787444,138710255,1,157360815,1,1,545865678,1,1,427838805,635619567,1,383065349,457098568,567385414,1,792563584,1,158864302,532181747,591979445,233213764,1,1,782084904,1,724464888,1,1,1,1,1,1,121134285,69218356,634516951,838686483,658518385,816643922,1,1,1,1,911931618,609803850,788833800,1,1,1,1,936643976,1,375253137,81895258,900281924,1,1,486013782,1,659101067,1,1,340562371,1,849297500,838479377,1,1,444106295,1,1,1,1,78599176,407084557,238298280,1,1,841376441,160634943,470362697,665566583,1,892489463,1,379919861,1,168396355,584772147,893914785,386139898,808843020,1,661113961,276876882,1,1,720381296,885478108,1,1,276158099,1,100589894,1,516508508,354633417,1,1,1,520090945,939312722,864105467,1,819076752,764423936,386036716,395693536,1,997929526,1,779101511,197994239,1,1,1,1,103718222,123271153,90309299,60097705,1,1,494165664,1,1,792109455,1,533322590,1,1,1,1,1,1,484003977,1,1,1,600080986,10334056,664802467,1,24737672,1,66209541,1,1,1,861645750,907095336,200115272,1,1,1,1,517001876,571646524,1,1,415472947,1,1,830374421,23973390,575997951,965346462,224214981,224134100,1,568478590,776678249,1,645424514,1,871866255,1,872150401,1,550849869,97278829,533928617,1,1,1,1,1,1,519161770,736380459,924924470,1,575136252,359434069,1,1,409228442,1,1,128164332,808162654,1,645180196,1,910083307,864997666,1,962651711,1,187780070,1,1,1,581324491,132188805,1,786058110,76544226,1,707022636,1,1,1,985166043,1,1,863068638,155666497,1,1,1,1,1,864182144,1,288978966,291954547,50358986,304863472,930760712,1,118854489,1,1,1,1,194080824,1,1,1,892232420,506975571,1,1,333425335,1,1,456306375,503302948,1,1,1,1,757575861,190485325,557971108,575945515,1,775505914,735602084,428245937,1,550437318,80906403,1,157686629,749167633,1,1,908299259,215545040,1,731138374,454865287,866011194,1,1,1,1,1,50404646,1,1,1,1,921373345,32478867,1,402331419,541890949,1,1,1,1,135295656,134014462,858412944,1,503944180,179802672,148783002,1,853922628,1,931573941,892944120,458890214,1,754838232,1,1,1,1,1,674269589,1,644747992,1,1,744233431,1,1,1,1,238249572,1,1,1,107578620,56778755,1,979872578,1,1,1,1,250870663,316565239,1,702549786,1,543369901,843895233,789685166,1,1,1,452528334,1,1,1,528957300,72086642,635603657,1,1,1,432304870,1,691387615,1,780992324,1,1,431125609,1,55595538,938658598,518541589,597029660,684959662,282319896,330525312,173719263,59879409,693016887,1,1,1,697624193,1,1,1,666294747,
1,25068886,666381581,837386781,1,1,895544206,1,1,637599026,132308103,1,1,225943568,1,423096459,1,1,1,408716737,1,1,1,766405659,204177199,797623138,582344869,870461387,619061477,530735201,1,1,874508637,1,1,1,160799496,1,474003061,854693771,395531013,42610135,910003268,457790298,57077775,1,994006780,1,867163170,603952986,752602682,503609168,783047135,1,547460772,137118217,1,1,416962991,261349181,369949876,733049201,1,1,1,198645135,686329597,510452161,798193487,507281736,12833644,473359013,1,451408564,281897367,826433915,1,1,1,1,1,1,957028611,482810168,1,1,1,592376183,24949620,1,897731658,801585917,921859405,1,1,1,1,1,1,799171973,447880959,1,1,1,1,1,321737878,1,1,1,473633049,563693140,565632406,1,621007579,845940641,1,494427368,1,873543036,1,800875503,1,999738502,1,499453115,138253736,447435910,1,1,170901836,1,1,870816781,1,1,338743356,1,1,1,597889153,1,1,1,1,821615170,494481427,987401619,1,667525289,116424376,1,742869096,1,1,1,116489927,961919820,445524170,1,1,1,1,1,1,1,309891628,482735616,139155996,927014916,428725919,13858872,1,1,894679668,782055857,828969761,770622328,1,1,1,1,169656979,1,693939196,55671127,1,571515695,968889138,1,1,726535312,737959417,716491851,832460716,247514434,1,1,1,287446909,202022327,984401882,1,1,1,887330803,187332486,1,281702506,833290585,232017449,19628210,1,33819849,497783237,1,608616345,575139568,1,1,231601667,1,913749608,1,15460231,1,548654479,366662399,1,475804,1,233786180,16581398,1,573902748,1,1,699778409,429231610,100323373,1,435352669,1,711668993,902285660,1,108066749,193813500,1,1,1,248196608,167356872,1,228717704,1,874570566,527153043,1,706806161,472484221,1,1,102806435,1,1,48943803,571487578,1,1,1,1,58393301,6859773,1,1,446449067,1,156723326,1,796959069,1,1,263545140,1,604973887,1,1,675076062,1,778971171,439549708,1,1,384477380,1,1,1,299057636,1,710038126,1,1,1,1,1,26611909,554942918,891469886,1,799052308,1,142230487,308300953,84471340,638479771,70827677,1,902933139,420832937,1,124547510,1,1,336876814,1,284346153,345349626,10715472,1,1,1,26015831,1,1,27468027,813812453,1,860596252,257154682,1,1,905552568,196899297,209096072,1,1,1,1,334676387,1,1,1,583009878,145391781,848765070,102278951,1,1,13545076,123338158,1,1,863129927,925194787,2303844,1,871500158,908357401,17356711,621800810,290888831,1,1,1,1,340847048,1,1,631127394,63536634,1,1,1,1,1,897257633,1,1,823432039,1,1,1,1,398123394,1,400428098,1,174590231,806949592,1,1,1,838318123,963063418,99246500,996751582,375747160,958476182,494542105,1,1,541963079,1,1,821381066,1,721749892,286407499,1,764552673,945449558,314527108,25717469,1,784784128,449038629,1,44914610,1,464724239,1,610225671,1,1,1,806405073,1,1,787880477,959864766,74245650,1,1,726238531,195565279,1,1,363264819,305533434,459279960,187242028,970856537,205495716,790708238,1,1,593143192,1,202450348,586226366,509878454,1,1,1,1,1,65438842,1,1,608723080,792053061,747866517,406817130,400719076,1,1,988848626,808843275,15703328,351283416,1,527795146,657973543,1,967611678,1,42236376,1,1,979960321,346317850,1,1,1,435053628,1,1,1,44257566,258988446,1,124039946,309976102,913168624,1,1,392827393,1,1,1,1,1,792370352,1,540156366,461119616,1,185337486,492356685,723331587,1,1,605298361,1,1,213838008,610830339,
1,135632853,376777471,1,704345087,380784553,819491384,1,1,836409506,694280392,309216465,1,80192917,1,427157842,690735825,1,1,1,1,384712751,634524569,1,1,72902570,1,332480112,873484555,384540941,1,1,705834936,1,52718848,800285484,1,1,1,1,1,972125276,821539563,922051033,138807742,1,1,924914978,452466669,123059204,1,1,1,1,644755780,493725970,685526171,1,272081887,1,554985431,1,1,806112433,788686569,790651851,1,1,1,302036204,1,1,463916692,1,32233089,1,1,1,124445892,1,1,162717396,637204218,955892081,98354777,371179881,845126375,80090209,746852050,1,655441715,1,335577983,560305268,411806714,1,349594805,611538925,125228775,1,1,952030237,1,1,564940081,1,1,1,1,433102405,1,706327688,986606209,929210455,882013600,269573581,1,1,1,1,333067618,326689421,10789968,989572777,1,749075639,623765521,1,25740999,1,1,389291166,701361135,1,1,481731906,1,1,1,1,1,669776717,923283381,1,401498514,1,1,442910099,1,771305858,1,620604457,913030016,1,1,1,189502319,288018738,193124032,171116015,509889042,548764241,50662147,923638827,1,1,433733435,22775338,1,1,631931094,34925458,1,1,121077285,1,759618234,214834932,1,301363868,832988762,1,1,669279073,411836688,343241230,1,43242033,432862376,1,1,1,1,8934434,172202743,545085086,621666450,7173942,1,1,1,151644709,1,1,589574021,1,212908751,855330881,186639066,1,1,70774445,294241432,1,132549345,1,114539693,1,1,1,1,1,892721672,1,721645334,913294442,836834433,224659286,434629311,824331809,1,1,818062264,83999139,1,1,519878765,1,1,1,1,465693357,974700597,200664008,1,1,245765779,1,1,581433198,22282668,175974132,195401925,1,1,777723752,97968367,74450874,810936870,1,363436559,624032582,1,263321537,1,938651045,850915821,681370329,255536548,727934581,1,611254332,979363907,1,1,729162376,1,152023709,1,1,82991334,993352810,82852677,1,324964868,728001790,1,235791866,932720879,66637903,749978503,224717841,1,850085388,1,1,781587436,922145194,948515129,17770559,827964228,1,573524696,852321142,1,1,1,1,1,206919145,80618618,1,245639459,32673239,508268251,1,1,1,1,1,1,709401226,1,745180226,1,771881302,1,1,782168026,684223907,108274514,10963233,625853132,1,626944024,577055646,920550791,123547613,44132866,1,1,352396497,477714545,1,708542006,974421949,1,767601769,1,614643254,1,1,684887694,1,1,1,1,1,427533075,1,1,1,244314987,627420959,1,1,983657563,76834369,1,1,978501505,112616622,378763906,1,1,1,364843688,1,1,1,922127295,1,1,1,196846991,894503649,14472055,357820917,459680317,565733839,1,1,924631564,178837246,736430854,394826998,1,32905166,1,1,274616032,126779837,795814153,333042774,1,1,979219524,1,1,1,1,1,472562361,1,652325550,1,1,511830398,1,1,1,10373879,1,1,561760144,860185768,412264241,1,1,979294243,474492958,673777011,1,1,539290013,1,622480716,54673475,628085276,821547520,1,1,1,1,316136016,1,1,1,729300532,724857414,1,1,1,1,265837236,48956005,1,1,113461220,898521200,456600861,1,1,988427568,829779453,1,178842370,1,1,1,1,575705609,571996241,605677363,1,1,840060441,373767563,1,1,1,308423586,364301319,1,1,1,1,736498119,737655901,342260267,1,56918068,931860065,607374155,1,216474467,114291053,1,1,902678267,
833822653,1,3636017,1,1,131707460,1,9232623,229481591,50106466,114161881,1,1,248918852,1,632718896,291850612,1,656115469,363289521,73203601,1,1,1,941444729,640024385,271917586,1,1,835345850,1,841042193,1,1,1,471595872,1,553085281,17885437,1,1,615255769,1,455781438,445097117,466537849,1,384507949,574586553,756354062,638614086,1,1,264029794,1,122023607,574680014,1,643466896,981791265,909392112,474286690,1,1,57463289,663675527,1,190110961,157183167,1,1,1,1,785359463,1,348359416,709528192,170830990,1,529063719,1,1,1,1,575645591,1,248878845,236615644,1,175692066,67149143,1,1,180481267,968247634,1,949680112,346130269,1,1,1,532208836,1,866777440,176359697,223326575,1,1,257068488,171526123,1,636375453,571766683,959846615,1,1,387055142,1,415137020,1,645810644,749380353,1,1,1,1,1,1,1,410312156,674327812,1,1,1,1,239299001,1,1,1,1,1,1,44402757,490649055,1,1,453831440,299186068,1,1,317530885,309018831,325119427,1,52070998,498806728,434334252,703347711,1,1,616368341,1,939134460,1,59849255,1,1,161935480,145515692,634592793,504962659,1,1,492420127,991722726,63094427,1,1,817147161,1,1,864054890,386791438,186363420,884030094,1,809927721,1,1,1,733371393,930479382,351908829,1,55513582,1,128022809,371410320,1,568815021,1,436191961,26088655,260124949,1,350873248,1,1,1,1,1,1,763919917,1,78658399,754173103,219278143,1,1,862642695,276464915,1,555511535,1,1,1,1,599418237,574202892,1,1,1,1,1,1,1,1,2786698,113837739,904418958,439568135,246950232,533357098,1,1,1,582357862,1,1,1,606913795,1,585777540,482890539,1,1,763673072,1,1,975175168,831886372,559767040,737591755,1,167880105,825336685,1,191515410,1,1,538341286,931726553,1,1,1,394900151,1,163877679,1,1,836349375,25034236,1,84800425,1,1,61437509,379240717,844351432,1,1,1,1,481059360,1,1,1,256119276,895656379,319002259,109807731,211844221,967563145,284490235,1,84152846,1,1,677090118,359795869,1,461322210,1,1,450270069,1,556242059,847346414,27730048,135009933,683914627,1,1,1,801579506,1,146777849,1,743617052,1,1,1,1,689476356,1,1,72842719,1,251512774,1,1,920525507,729358015,1,506593321,816123404,1,1,1,623354549,1,417280411,199458284,1,1523298,1,17712812,354999748,1,1,1,1,1,1,747213788,469266359,853690524,1,501313152,470933805,132198518,1,1,1,670029427,1,1,1,1,1,58614254,270337260,1,342439080,1,1,1,751587244,675643536,871235764,501454473,783393960,522142222,22896739,492617209,1116302,1,946103360,1,58369705,1,1,223332170,724328277,1,1,346398843,1,740731510,1,205565622,490414478,121003999,714971928,1,1,1,1,531820899,823335136,444588283,1,1,898627754,865153615,599109521,1,373650686,891080455,35354433,402994817,257471291,436076864,1,267802844,37285479,355213553,1,472154446,1,1,907746236,1,488358121,1,26122734,1,1,613001532,1,598997632,466204889,1,958056139,950675335,1,11639037,1,368009565,24525761,233602389,1,1,877417295,989814092,969828701,1,771393701,71370861,767974373,1,1,1,1,1,1,198016911,894448704,1,949894714,9294816,1,558819189,1,1,342162152,716076077,1,1,402748457,170525138,753323096,
1,65550876,1,1,1,1,1,858361724,811483541,829813486,806356989,1,1,309191694,615755644,816118088,289689880,78563868,404999578,1,39216215,1,1,1,922973153,658534208,467701100,1,863196598,278331371,1,1,1,1,368386644,283230881,783075920,128756222,365387931,371967765,1,605711635,1,1,1,657639668,480987639,400474403,1,41941712,1,381744361,451617193,1,1,1,436035650,1,988569165,1,848063422,227013028,954098647,446450547,473235185,1,1,667960121,1,1,1,169805166,373881928,387943298,692789928,527393924,531062173,428640144,1,66361526,1,1,1,659833287,1,1,532957724,1,909151754,1,1,1,535938481,140344022,208373609,1,540500437,203481555,1,729870421,1,50380191,744005879,1,1,1,1,1,674630677,452329544,1,1,1,1,1,1,893254820,1,1,1,1,1,1,736493381,1,1,1,1,204284610,1,510567002,1,2889801,506445093,1,320378729,915377060,1,217865202,714052803,727561023,505892810,614272904,683638834,291433765,1,1,1,205926348,279236232,1,419262965,178074947,993252612,1,1,1,331210373,1,761786811,605027505,1,745291702,1,1,1,1,1,126140808,1,1,353090069,1,1,295399997,229592487,1,212167049,123547948,986553187,1,1,1,159954042,647394487,499457371,1,774518681,48073836,1,156367703,1,1,1,630331164,1,896455224,391992587,1,38156660,1,49505759,959207397,1,1,51351205,1,107792204,1,1,323870496,836124755,541306704,886892216,608979184,895952252,310467957,555706078,1,1,373968670,774652256,989140176,1,1,949742780,1,1,1,1,959225991,683943194,1,1,771677251,1,1,1,74029314,217930609,1,1,651365370,1,418046349,1,1,1,1,1,692263733,910524970,1,1,345802269,643757498,359311315,1,901690295,419819916,654433909,1,704144246,1,573363069,696601376,377983773,1,77464223,1,252153516,1,1,1,1,283604345,1,1,873690678,1,1,481720075,1,903431964,980138196,1,322577848,1,607255863,1,857641902,573309966,1,978320472,1,1,900839440,117158320,514260616,1,1,1,1,1,1,1,1,25457758,1,215957185,688614874,768836006,1,637464237,13250067,1,674408566,1,1,1,1,359119753,537234064,1,1,450320933,1,413872143,1,72615226,482844186,1,697261520,484660275,989878796,75374994,60812269,1,1,1,1,1,252953442,1,247311436,1,1,1,53024206,759722854,1,895517507,84468253,273960951,1,929441439,1,1,1,643720012,470377912,987819289,659919036,1,1,1,1,971479602,1,94885112,345608184,779273552,1,614523856,1,840453525,688243529,876898487,1,1,1,511331641,1,747314997,1,559311604,884875954,869780279,752126192,1,980499502,55218292,1,1,1,848727840,1,1,1,1,519579663,1,853872420,1,1,230262851,1,1,480616135,1,1,1,1,1,1,1,1,200287266,1,1,349264821,1,538858569,1,482093224,1,1,48965962,884540265,1,940597669,859627932,1,1,1,1,1,879021830,493215368,649036619,544274070,586319337,159925927,465536775,1,1,1,1,586401769,802548027,20471527,1,223194743,1,1,1,1,1,662551935,1,425968285,785245061,1,1,981199620,1,420086827,1,346305891,1,1,1,211340413,1,268628180,1,1,886030996,1,1,1,1,977619883,478631501,1,398593653,1,1,999581801,1,698368758,1,470721369,928463277,1,1,16263613,659326341,1,969027909,1,1,513026580,1,1,1,1,635578066,209839879,1,13491484,1,1,260232182,1,1,466799247,1,462570840,1,817471911,1,970292,979568360,593403915,1,161931143,374858402,769459861,434665245,1,272778897,1,1,1,1,1,
814449537,216398410,1,886497677,950886509,1,1,1,137847779,1,143257204,571684834,1,595869004,1,1,432630049,589316952,1,1,325311389,358433428,1,559391320,1,1,876569796,357656553,290661795,1,914710527,448803331,1,1,652515707,276558459,727199384,1,1,133615501,3867643,456655366,201806125,745566726,1,635580087,1,432844262,1,282201072,1,447650518,1,1,399595998,976880841,236726901,75549780,1,1,944928521,732020303,1,1,789703992,1,1,631235449,1,665493598,1,413318515,1,1,1,817580765,938113637,1,1,1,1,703111694,1,558185675,463298857,1,1,1,335711109,1,170062654,1,30560157,1,1,1,1,1,1,227439622,1,1,225179744,805296796,825219195,1,1,1,291735918,1,936541574,1,436339543,753414490,210532252,724196667,1,806148625,474477487,1,522440648,374387736,664016068,815676467,421051913,797912239,1,363299923,50856854,928028811,830534768,727064067,163793686,292877062,815329189,469914290,1,301724032,1,1,1,1,1,384383341,521899105,1,375462801,523088684,1,415163300,1,1,1,1,570550308,1,727396844,923243757,43714598,605516036,761095830,1,717422900,416770070,1,315806289,1,1,1,1,377448501,486754649,1,1,1,730307913,980723562,1,316297430,1,776707677,1,1,1,1,992009900,407474951,1,45637741,77468420,1,1,841783618,1,1,1,1,1,986848003,477588429,696093357,1,198896133,1,405488335,976090994,919742248,1,1,111551218,626964499,839108623,655801355,1,1,1,1,1,1,1,1,748640009,1,1,1,1,1,954268186,666666229,318547853,1,701379943,1,1,375205341,461116220,1,1,482529510,1,300517523,275215855,1,679049143,106911306,1,1,1,498080935,1,203203900,84827036,211315256,811029253,1,888939812,1,1,232922184,1,491183048,1,477807010,1,702968732,1,354882044,577529497,365219175,276098726,1,95246024,1,1,523165421,650399430,1,641980819,674222575,1,107783955,637030390,486275024,1,1,756866030,1,1,1,738284150,1,756345896,919278734,1,1,712223683,469004225,861216498,88016287,494263300,1,1,56281655,267452837,950086160,751610448,1,975237635,1,1,502852590,1,1,1,1,1,205526673,587771907,1,1,307420276,846843849,1,71457531,1,574486915,376927034,940774214,716028699,462067583,236993057,1,31354459,510280095,377567627,1,1,1,1,497164333,759901150,1,1,1,638045870,721805244,877708287,1,581434037,795924169,1,956143231,792309248,359803716,1,1,1,43168818,1,296094285,885864724,1,559932826,1,195347382,321108539,1,931112450,632606548,296911921,1,1,780141623,1,147233133,638813884,1,1,402373268,399283275,406899775,1,1,1,1,1,396521846,1,1,1,1,421488260,1,477185440,356065470,1,1,562210560,1,975419055,558328007,987134729,429984583,1,883319337,1,1,865697869,806538426,812683333,647624224,1,20927694,1,245005278,996076562,945745026,1,971473787,267756506,638451724,229681332,942215219,1,1,799463794,1,290328950,792767908,1,1,469372750,674664263,825491670,208806760,1,1,1,981992574,1,459544163,1,1,1,784957262,993958291,1,308172965,1,1,1,1,959466022,1,73425420,1,514144585,759157603,599608291,253126229,1,1,1,712934539,417145315,1,1,247645282,913500361,1,1,1,1,121183833,728830292,1,1,947007381,772926373,1,741874183,1,1,1,700720254,
335578833,462185733,1,1,452295384,1,543060677,640131968,1,1,159021419,914435876,1,1,1,1,944333621,1,800045865,1,707410962,283849933,917346028,262658484,777200372,1,1,1,588713636,31964882,1,856542117,278225038,713820185,1,1,1,964636486,1,1,1,671626938,1,1,1,1,1,1,493402008,1,1,1,1,914459388,255940792,1,1,209668217,849299893,1,905132479,1,1,944690634,25852994,1,1,1,119321602,565533183,682263616,1,986740819,1,1,353070887,913091409,993194229,1,1,1,1,460569158,1,958646516,1,1,1,1,427797032,1,763166280,1,1,1,224376913,1,784928550,1,610752191,353790844,1,979955072,535674927,902239189,1,1,1,1,1,1,265401713,1,1,1,406604561,1,413276672,760856396,1,463963937,1,189314386,404974307,640279606,1,976475023,1,1,638322517,1,1,149442323,1,1,1,153750917,1,1,619719201,815364638,744165574,70548627,1,876697623,314566150,371668367,9545067,1,526644865,922073679,418517990,211718427,45159149,608177115,574003406,147398789,894105006,406161184,546735213,50511425,275581302,1,955373742,1,1,1,1,1,1,394685677,1,729921444,1,838171971,1,60710985,420493575,683746786,406593162,1,1,282396261,423762517,1,288605711,1,1,1,878644935,1,995395377,1,1,1,1,138545482,1,1,1,18440388,333333711,704122041,1,1,1,699454348,1,1,1,709561242,1,890139873,246160160,1,1,1,1,798932058,983138836,1,79491506,697295113,1,950383283,1,1,228740162,323644571,1,543966927,554320743,931977927,547269106,1,1,1,951454169,380054383,135785738,4116722,1,175502335,1,1,1,1,1,1,570226616,270602334,1,447507443,1,289787215,1,1,1,1,1,813143222,1,458230693,1,1,1,1,1,1,507846032,228676499,789151632,1,675712562,407756071,1,1,229346957,561943783,1,1,1,1,1,565960967,1,1,733801344,627021532,1,1,314635753,112930367,918235583,817651967,565121894,1,534860464,1,1,971561989,1,703139352,1,1,1,1,1,1,1,486333009,640014940,376596729,188606927,681577032,858379097,561882606,1,1,1,922032365,1,1,1,256053363,1,47268211,1,690533399,1,1,994210925,1,1,391377145,1,1,1,1,1,1,47659504,1,20947714,509122865,75309164,248001002,1,1,1,809937136,1,1,30524486,1,1,1,241423478,720894280,1,1,38439951,1,1,972451138,779573909,923639133,1,1,1,1,1,656715595,665665997,333884263,1,715420391,1,860109806,1,296545434,1,883569173,1,762759352,622382777,1,486816589,950900348,1,1,504079884,1,918143542,648100128,164738321,673117929,1,840183425,1,784539000,1,505436749,1,127789302,1,785155810,1,1,958627107,1,263037346,1,264368203,1,1,929164100,1,88425669,1,781678769,637795530,638363045,1,1,1,1,601228384,1,339627671,1,554410013,744332304,185506711,563031464,422832593,1,1,506257349,244992871,1,96169268,522634103,1,1,1,1,309069280,577517993,1,60153825,869802168,795504088,158430600,693546864,56865578,1,1,261752992,1,1,791879989,71820176,1,1,1,704732450,1,1,831362129,467968223,1,1,1,1,1,545398622,477784074,1,1,1,743896692,1,415129483,396244095,338438812,1,1,670856813,93157518,336245237,473810287,1,1,875305950,1,813180003,566306243,1,202429176,840482942,84602056,78188872,910548143,934677883,1,642951945,1,1,368118388,861925164,1,141529489,1,113343823,1,637551747,1,1,1,1,1,1,1,1,107871882,709632735,777935973,458125869,1,1,38473970,1,3516963,269485559,1,199853857,1,1,1,1,292945803,1,453059217,870890532,1,
729027091,1,685131838,499431455,1,997113908,1,1,839881494,441556771,90917500,1,403294665,1,1,1,1,1,1,928464155,1,1,1,754498041,893552391,761754956,1,111473758,1,337919033,1,525488450,771762571,263505387,189946172,1,1,925180011,1,1,1,1,233786747,161812209,1,1,1,211208026,898837101,147021259,936315157,1,227097688,690682059,693460810,680527413,1,826957106,1,1,116137501,530496872,330924841,948173849,1,182016720,1,1,1,140757150,539113057,911614963,1,544174640,110096663,929341335,557789524,1,1,377524055,1,1,1,403146394,1,232810785,1,350585050,1,1,279318757,1,1,1,1,1,1,231556534,1,1,357502327,458994943,1,1,274414300,1,497143736,1,11701893,1,983950464,282161270,1,824926564,720366209,49280400,691988979,912747880,827006303,1,1,1,1,1,1,1,40245310,1,1,189514032,816450195,1,289989002,1,22163612,883717862,136253172,1,67340257,1,1,342213325,1,1,1,1,756885249,891881469,1,448580335,1,1,900183801,1,653902015,313787472,1,483916451,594174657,870126218,39939418,1,239397226,1,1,801267621,564762871,1,1,1,1,300031751,1,1,1,1,676687959,1,1,1,347754366,295991819,768906115,1,148645460,216604153,343903039,1,555408599,946574264,1,1,390494602,1,1,1,886018121,368748730,1,177142923,1,12359035,893906782,1,933180750,1,1,893084242,85327313,985030389,930311158,1,820479493,1,1,122884475,1,664469482,175833679,1,643540957,1,538782324,1,1,1,1,1,532970222,969568855,608027989,1,249144784,1,295795729,1,1,816965078,1,1,1,1,1,1,1,851998233,142979873,1,1,526895825,1,162325400,1,1,1,248640706,773596063,1,1,838685576,1,712073175,1,923878907,1,468010916,433635226,127613478,22832205,66339141,227843408,281623887,1,1,1,1,713325589,1,215202387,1,896955940,516738526,1,764619758,1,763450389,1,1,1,1,1,1,306537710,656950648,306255040,1,956207129,1,153252534,1,1,443260642,1,1,949134541,1,809463472,326911173,1,175926230,1,492880443,1,917486333,271806541,103906631,940812623,1,1,647874595,1,1,1,27504324,1,131302480,691406213,88950553,1,1,203002346,1,1,808149233,739227910,1,633736383,832223933,617466036,1,450431697,54715139,267310966,806965815,1,1,930973995,1,1,109100205,859295828,531880077,1,1,590473377,146120068,1,1,1,1,1,1,120604048,409610342,417613313,1,1,1,1,1,468880177,1,856768836,2511241,528330206,956993269,1,1,690772630,1,1,916143076,1,674402979,279385060,565188769,339224258,754332718,392758815,1,1,1,307232458,560206757,38758651,1,1,1,1,1,948065021,646920113,822330312,156980670,1,1,1,15701606,1,1,1,717328953,1,830118273,101023766,1,1,235900066,125354352,676934302,1,256733761,1,1,4204506,1,347336433,1,613374534,1,1,479229755,197381704,1,1,1,788147449,393422424,1,109124609,50245678,255552310,464289727,750163922,948447400,247244588,1,1,709783131,1,1,137915951,1,5468298,1,1,385387738,1,517935805,487833670,116312015,863285306,272712710,1,946690009,1,1,904939707,1,286857318,1,782185536,515043747,59255428,572950646,138286181,407573209,1,161954249,1,1,1,1,1,1,1,1,1,87721910,409265238,455781830,24487926,435869264,1,821275767,887475014,176005222,1,1,825714598,1,759809840,1,1,1,358433794,1,188614164,1,289512685,424076083,254206158,878400106,797733641,438231076,440406895,118077100,1,422234014,1,1,453178746,1,1,839648098,593839424,1,1,1,190444706,293162308,660895932,118807570,1,1,832642903,825369861,1,1,480497165,1,905161955,949768629,206516460,145623098,585017323,1,1,129881896,1,
69775482,566057806,300292859,904609120,1,840370705,193089719,551028224,1,555274882,1,559067062,726864870,1,993923926,759112082,1,1,872754213,479017250,1,1,1,733949955,695268614,956077651,1,167274684,863457157,223218255,575047552,50722108,975517532,337074148,1,1,723589723,1,456240878,576765616,611104601,1,178283001,1,805165745,61808437,1,1,742588830,1,1,47342300};
void build(int u)//建树核心代码 
{	
	int flag=0;
	for(int i=0;i<=g[u].size();i++)
	{
		int v=ys[g[u][i]];
		if(!vis[v])
		{
			vis[v]=1;
			fa[v]=u;
			build(v);
			flag++;
			xb[u]+=(1+xb[v]);
			ans[u]=(ans[v]+ans[v+1]*ans[u]%mod)%mod;
		}
	}
	ans[u]=(ans[u]+mi(2,cd[u].zcity)*mi(2,cd[u].zedge)%mod*mi(2,flag)%mod)%mod;
	if(flag>0)
	{
		ans[u]=ans[u]*(mi(2,cd[u].zcity)*mi(2,cd[u].zedge)%mod)%mod;
		ans[u]=ans[u]*xs[flag]%mod;
		ans[u]=ans[u]*mi(2,zb-xb[u])%mod;
	}
} 

int main()
{
	freopen("barrack.in","r",stdin);
	freopen("barrack.out","w",stdout);
	//一、输入n,m 
	scanf("%d%d",&n,&m);
	zb=m;
	
	//二、超点的初始化 
	for(int i=1;i<=n;i++)
	{
		ys[i]=i;
		cd[i].zcity=1;
		cd[i].zedge=0;
	}
	
	//三、输入边 
	for(int i=1;i<=m;i++)
	{
		int u,v;
		scanf("%d%d",&u,&v);
		g[u].push_back(v);
		g[v].push_back(u);
	}
	
	//四、缩点变树 
	lb[1]=0;
	To_Tree(1,1);
	return 0;
	//五、树上计算 
	//（一）结论：对于一棵树，
	//只有让他的每个分支的末端以上
	//直至LCA都派兵守着，才可满足条件 
	//（二）步骤 
	//1.建树+初始化ans[任意节点]
	memset(vis,0,sizeof(vis));
	vis[ys[1]]=1;
	build(ys[1]);
	 
	//2. 枚举LCA
	for(int i=1;i<=n;i++)
	{
		if(ys[i]!=i)continue;
		cnt=(cnt+ans[i])%mod;
	} 
	printf("%lld",cnt);
	return 0;
}
